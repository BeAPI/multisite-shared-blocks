(()=>{"use strict";var e,t={843:(e,t,o)=>{const r=window.wp.blocks,l=window.React;var n=o.n(l);const s=window.wp.blockEditor,i=window.wp.element,a=window.wp.components,c=window.wp.i18n;var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},h(e,t)},p=function(){return p=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var l in t=arguments[o])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},p.apply(this,arguments)},u="Pixel",d="Percent",m={unit:d,value:.8};function v(e){return"number"==typeof e?{unit:d,value:100*e}:"string"==typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:u,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:d,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),m):(console.warn("scrollThreshold should be string or number"),m)}const f=function(e){function t(t){var o=e.call(this,t)||this;return o.lastScrollTop=0,o.actionTriggered=!1,o.startY=0,o.currentY=0,o.dragging=!1,o.maxPullDownDistance=0,o.getScrollableTarget=function(){return o.props.scrollableTarget instanceof HTMLElement?o.props.scrollableTarget:"string"==typeof o.props.scrollableTarget?document.getElementById(o.props.scrollableTarget):(null===o.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},o.onStart=function(e){o.lastScrollTop||(o.dragging=!0,e instanceof MouseEvent?o.startY=e.pageY:e instanceof TouchEvent&&(o.startY=e.touches[0].pageY),o.currentY=o.startY,o._infScroll&&(o._infScroll.style.willChange="transform",o._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},o.onMove=function(e){o.dragging&&(e instanceof MouseEvent?o.currentY=e.pageY:e instanceof TouchEvent&&(o.currentY=e.touches[0].pageY),o.currentY<o.startY||(o.currentY-o.startY>=Number(o.props.pullDownToRefreshThreshold)&&o.setState({pullToRefreshThresholdBreached:!0}),o.currentY-o.startY>1.5*o.maxPullDownDistance||o._infScroll&&(o._infScroll.style.overflow="visible",o._infScroll.style.transform="translate3d(0px, "+(o.currentY-o.startY)+"px, 0px)")))},o.onEnd=function(){o.startY=0,o.currentY=0,o.dragging=!1,o.state.pullToRefreshThresholdBreached&&(o.props.refreshFunction&&o.props.refreshFunction(),o.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame((function(){o._infScroll&&(o._infScroll.style.overflow="auto",o._infScroll.style.transform="none",o._infScroll.style.willChange="unset")}))},o.onScrollListener=function(e){"function"==typeof o.props.onScroll&&setTimeout((function(){return o.props.onScroll&&o.props.onScroll(e)}),0);var t=o.props.height||o._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;o.actionTriggered||((o.props.inverse?o.isElementAtTop(t,o.props.scrollThreshold):o.isElementAtBottom(t,o.props.scrollThreshold))&&o.props.hasMore&&(o.actionTriggered=!0,o.setState({showLoader:!0}),o.props.next&&o.props.next()),o.lastScrollTop=t.scrollTop)},o.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},o.throttledOnScrollListener=function(e,t,o,r){var l,n=!1,s=0;function i(){l&&clearTimeout(l)}function a(){var e=this,a=Date.now()-s,c=arguments;function h(){s=Date.now(),o.apply(e,c)}n||(r&&!l&&h(),i(),void 0===r&&a>150?h():!0!==t&&(l=setTimeout(r?function(){l=void 0}:h,void 0===r?150-a:150)))}return"boolean"!=typeof t&&(r=o,o=t,t=void 0),a.cancel=function(){i(),n=!0},a}(0,o.onScrollListener).bind(o),o.onStart=o.onStart.bind(o),o.onMove=o.onMove.bind(o),o.onEnd=o.onEnd.bind(o),o}return function(e,t){function __(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}(t,e),t.prototype.componentDidMount=function(){if(void 0===this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"==typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!=typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?p(p({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var o=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,r=v(t);return r.unit===u?e.scrollTop<=r.value+o-e.scrollHeight+1:e.scrollTop<=r.value/100+o-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var o=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,r=v(t);return r.unit===u?e.scrollTop+o>=e.scrollHeight-r.value:e.scrollTop+o>=r.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=p({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),o=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),r=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return n().createElement("div",{style:r,className:"infinite-scroll-component__outerdiv"},n().createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&n().createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},n().createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!o&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(l.Component),g=window.wp.apiFetch;var b=o.n(g);const w=window.wp.url;function _({onItemSelect:e}){const{sites:t=[],post_types:o=[]}=multisiteSharedBlocksEditorData,r=Object.keys(t).map((e=>({label:t[e],value:e}))),n=Object.keys(o).map((e=>({label:o[e],value:e}))),[s,h]=(0,i.useState)({search:"",postType:"",site:0}),[p,u]=(0,i.useState)([]),[d,m]=(0,i.useState)(!0),[v,g]=(0,i.useState)(1),[_,E]=(0,i.useState)(!1),y=()=>{u([]),g(1),E(!1),m(!0)};(0,i.useEffect)((()=>{const e=void 0===window.AbortController?void 0:new window.AbortController;return k(s,e),()=>e?.abort()}),[s]);const k=(e,t)=>{(function(e,t){const o=(0,w.addQueryArgs)("/multisite-shared-blocks/v1/search",{search:e.search||"",post_type:e.postType&&""!==e.postType?[e.postType]:[],site_in:e.site&&0!==e.site?[e.site]:[],page:e.page||1,per_page:e.per_page||30});return b()({path:o,signal:t?.signal})})({...e,page:v},t).then((e=>p.length||e.length?e.length?(u([...p,...e]),g(v+1),m(!0),void E(!0)):void E(!1):(m(!1),void E(!1)))).catch((e=>{E(!1),"rest_search_invalid_page_number"!==e.code&&(u([]),m(!1),g(1))}))};return(0,l.createElement)("div",{className:"shared-block-selector"},(0,l.createElement)("div",{className:"shared-block-selector__filters"},(0,l.createElement)("div",{className:"filter filter--sites"},(0,l.createElement)(a.SelectControl,{label:(0,c.__)("Filter by site","multisite-shared-blocks"),value:s.site,options:[{value:0,label:(0,c.__)("All","multisite-shared-blocks")},...r],onChange:e=>{var t;t="0"!==e?+e:0,h({...s,site:t}),y()}})),(0,l.createElement)("div",{className:"filter filter--posttypes"},(0,l.createElement)(a.SelectControl,{label:(0,c.__)("Filter by post type","multisite-shared-blocks"),value:s.postType,options:[{value:0,label:(0,c.__)("All","multisite-shared-blocks")},...n],onChange:e=>{var t;t="0"!==e?e:"",h({...s,postType:t}),y()}})),(0,l.createElement)(a.TextControl,{label:(0,c.__)("Search for a shared block","multisite-shared-blocks"),className:"filter filter--search",onChange:e=>{var t;t=e,h({...s,search:t}),y()}})),(0,l.createElement)("div",{className:"shared-block-selector__results"},d?(0,l.createElement)(f,{dataLength:p.length,next:()=>k(s),hasMore:_,height:300,loader:(0,l.createElement)(a.Spinner,null)},p.map((t=>(0,l.createElement)("div",{key:t.id,className:"results__item"},(0,l.createElement)(a.Button,{variant:"link",label:(0,c.sprintf)(
//translators: %s shared block title
(0,c.__)('Select block "%s"',"multisite-shared-blocks"),t.block_title),onClick:()=>{e(t)}},`${t.full_block_title}`))))):(0,l.createElement)("div",{className:"no-results"},(0,c.__)("No results.","multisite-shared-blocks"))))}const E=window.wp.primitives,y=(0,l.createElement)(E.SVG,{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},(0,l.createElement)(E.Path,{fill:"#000",fillRule:"evenodd",d:"M14.247 0H9.753c-.715 0-1.327.647-1.327 1.402V4.8c0 .755.612 1.402 1.327 1.402h1.736v2.034c-1.599.242-2.857 1.601-3.04 3.306h-1.3v-1.295c0-.755-.613-1.402-1.328-1.402H1.328C.613 8.845 0 9.492 0 10.247v3.398c0 .755.613 1.402 1.328 1.402H5.82c.715 0 1.328-.647 1.328-1.402V12.62h1.329c.262 1.602 1.48 2.859 3.011 3.09v2.088H9.753c-.715 0-1.327.647-1.327 1.402v3.398c0 .755.612 1.402 1.327 1.402h4.494c.715 0 1.328-.647 1.328-1.402V19.2c0-.809-.613-1.402-1.328-1.402H12.51V15.71c1.53-.231 2.75-1.488 3.011-3.09h1.329v1.025c0 .755.613 1.402 1.328 1.402h4.493c.715 0 1.328-.647 1.328-1.402v-3.398c0-.755-.613-1.402-1.328-1.402H18.18c-.715 0-1.328.647-1.328 1.402v1.295h-1.3c-.183-1.705-1.441-3.064-3.04-3.306V6.202h1.736c.715 0 1.328-.647 1.328-1.402V1.402C15.575.593 14.962 0 14.247 0Zm.306 4.746c0 .162-.153.324-.306.324H9.753c-.153 0-.306-.162-.306-.324V1.402c0-.162.153-.323.306-.323h4.494c.153 0 .306.108.306.323v3.344ZM12 9.276c-1.41 0-2.553 1.208-2.553 2.697 0 1.49 1.143 2.697 2.553 2.697s2.553-1.208 2.553-2.697c0-1.49-1.143-2.697-2.553-2.697Zm10.979 4.369c0 .162-.153.324-.307.324H18.18c-.153 0-.307-.162-.307-.324v-3.398c0-.162.154-.323.307-.323h4.493c.154 0 .307.161.307.323v3.398Zm-17.158.324c.153 0 .307-.162.307-.324v-3.398c0-.162-.154-.323-.307-.323H1.328c-.154 0-.307.161-.307.323v3.398c0 .162.153.324.307.324H5.82Zm8.426 8.898c.153 0 .306-.161.306-.323v-3.398c0-.162-.153-.323-.306-.323H9.753c-.153 0-.306.161-.306.323v3.398c0 .162.153.323.306.323h4.494Z",clipRule:"evenodd"}));(0,r.registerBlockType)("multisite-shared-blocks/shared-block",{icon:y,edit:function({attributes:e,setAttributes:t}){const{blockId:o,blockTitle:r,display:n}=e,h=!!(o&&o.length>0),[p,u]=(0,i.useState)(!1),d=e=>{t({display:e})};return(0,l.createElement)("div",{...(0,s.useBlockProps)()},(0,l.createElement)(s.InspectorControls,null,(0,l.createElement)(a.PanelBody,{title:(0,c.__)("Display options","multisite-shared-blocks")},(0,l.createElement)(a.ButtonGroup,null,(0,l.createElement)(a.Button,{onClick:()=>d("full"),isPressed:"full"===n},(0,c.__)("Full content","multisite-shared-blocks")),(0,l.createElement)(a.Button,{onClick:()=>d("excerpt"),isPressed:"excerpt"===n},(0,c.__)("Excerpt","multisite-shared-blocks"))))),!h||p?(0,l.createElement)("div",{className:"shared-block-selector-wrapper"},h&&(0,l.createElement)("div",{className:"shared-block-selector-wrapper__cancel"},(0,l.createElement)("div",{className:"shared-block-selector-wrapper__cancel--message"},(0,c.__)("Cancel changes and keep current selected block ?","multisite-shared-blocks")),(0,l.createElement)(a.Button,{className:"shared-block-selector-wrapper__cancel--button",variant:"secondary",isDestructive:!0,onClick:()=>u(!1)},(0,c.__)("Cancel changes","multisite-shared-blocks"))),(0,l.createElement)(_,{onItemSelect:e=>{var o;t({siteId:(o=e).site_id,postId:o.post_id,blockId:o.block_id,blockTitle:o.full_block_title}),u(!1)}})):(0,l.createElement)(a.Placeholder,{icon:y,label:(0,c.__)("Shared Block","multisite-shared-blocks"),className:"shared-block-placeholder"},"full"===n?(0,l.createElement)("p",null,(0,i.createInterpolateElement)((0,c.sprintf)(
// translators: %s is the shared block's title
(0,c.__)('Shared block <strong>"%s"</strong> will be displayed here.',"multisite-shared-blocks"),r),{strong:(0,l.createElement)("strong",null)})):(0,l.createElement)("p",null,(0,i.createInterpolateElement)((0,c.sprintf)(
// translators: %s is the shared block's title
(0,c.__)('Excerpt for the shared block <strong>"%s"</strong> will be displayed here.',"multisite-shared-blocks"),r),{strong:(0,l.createElement)("strong",null)})),(0,l.createElement)(a.Button,{variant:"primary",onClick:()=>u(!0)},(0,c.__)("Choose a new block","multisite-shared-blocks"))))}})}},o={};function r(e){var l=o[e];if(void 0!==l)return l.exports;var n=o[e]={exports:{}};return t[e](n,n.exports,r),n.exports}r.m=t,e=[],r.O=(t,o,l,n)=>{if(!o){var s=1/0;for(h=0;h<e.length;h++){for(var[o,l,n]=e[h],i=!0,a=0;a<o.length;a++)(!1&n||s>=n)&&Object.keys(r.O).every((e=>r.O[e](o[a])))?o.splice(a--,1):(i=!1,n<s&&(s=n));if(i){e.splice(h--,1);var c=l();void 0!==c&&(t=c)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[o,l,n]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={261:0,570:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var l,n,[s,i,a]=o,c=0;if(s.some((t=>0!==e[t]))){for(l in i)r.o(i,l)&&(r.m[l]=i[l]);if(a)var h=a(r)}for(t&&t(o);c<s.length;c++)n=s[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(h)},o=globalThis.webpackChunkmultisite_shared_blocks=globalThis.webpackChunkmultisite_shared_blocks||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var l=r.O(void 0,[570],(()=>r(843)));l=r.O(l)})();